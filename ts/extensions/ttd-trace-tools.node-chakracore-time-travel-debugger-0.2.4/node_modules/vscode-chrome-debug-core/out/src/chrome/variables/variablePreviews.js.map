{"version":3,"sources":["src/chrome/variables/variablePreviews.ts"],"names":[],"mappings":"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","file":"variablePreviews.js","sourcesContent":["/*---------------------------------------------------------\n * Copyright (C) Microsoft Corporation. All rights reserved.\n *--------------------------------------------------------*/\n\nimport Crdp from '../../../crdp/crdp';\n\nexport function isIndexedPropName(name: string): boolean {\n    return !!name.match(/^\\d+$/);\n}\n\nconst PREVIEW_PROPS_DEFAULT = 3;\nconst PREVIEW_PROPS_CONSOLE = 8;\nconst PREVIEW_PROP_LENGTH = 50;\nconst ELLIPSIS = '…';\nfunction getArrayPreview(object: Crdp.Runtime.RemoteObject, context?: string): string {\n    let value = object.description;\n    if (object.preview) {\n        const numProps = context === 'repl' ? PREVIEW_PROPS_CONSOLE : PREVIEW_PROPS_DEFAULT;\n        const indexedProps = object.preview.properties\n            .filter(prop => isIndexedPropName(prop.name));\n\n        // Take the first 3 props, and parse the indexes\n        const propsWithIdx = indexedProps.slice(0, numProps)\n            .map((prop, i) => {\n                return {\n                    idx: parseInt(prop.name, 10),\n                    value: propertyPreviewToString(prop)\n                };\n            });\n\n        // Insert ... where there are undefined indexes\n        const propValues: string[] = [];\n        for (let i = 0; i < propsWithIdx.length; i++) {\n            const prop = propsWithIdx[i];\n\n            const prevIdx = i === 0 ? -1 : propsWithIdx[i - 1].idx;\n            if (prop.idx > prevIdx + 1) {\n                propValues.push(ELLIPSIS);\n            }\n\n            propValues.push(prop.value);\n        }\n\n        let propsPreview = propValues.join(', ');\n        if (object.preview.overflow || indexedProps.length > numProps) {\n            propsPreview += ', ' + ELLIPSIS;\n        }\n\n        value += ` [${propsPreview}]`;\n    }\n\n    return value;\n}\n\nfunction getObjectPreview(object: Crdp.Runtime.RemoteObject, context?: string): string {\n    let value = object.description;\n    if (object.preview) {\n        const numProps = context === 'repl' ? PREVIEW_PROPS_CONSOLE : PREVIEW_PROPS_DEFAULT;\n        const props = object.preview.properties.slice(0, numProps);\n        let propsPreview = props\n            .map(prop => {\n                const name = prop.name || `\"\"`;\n                return `${name}: ${propertyPreviewToString(prop)}`;\n            })\n            .join(', ');\n\n        if (object.preview.overflow || object.preview.properties.length > numProps) {\n            propsPreview += ', …';\n        }\n\n        value += ` {${propsPreview}}`;\n    }\n\n    return value;\n}\n\nfunction propertyPreviewToString(prop: Crdp.Runtime.PropertyPreview): string {\n    const value = typeof prop.value === 'undefined' ?\n        `<${prop.type}>` :\n        trimProperty(prop.value);\n\n    return prop.type === 'string' ?\n        `\"${value}\"` :\n        value;\n}\n\nfunction trimProperty(value: string): string {\n    return (value !== undefined && value !== null && value.length > PREVIEW_PROP_LENGTH) ?\n        value.substr(0, PREVIEW_PROP_LENGTH) + ELLIPSIS :\n        value;\n}\n\nexport function getRemoteObjectPreview(object: Crdp.Runtime.RemoteObject, stringify = true, context?: string): string {\n    if (object) {\n        if (object.type === 'object') {\n            return getRemoteObjectPreview_object(object, context);\n        } else if (object.type === 'function') {\n            return getRemoteObjectPreview_function(object, context);\n        } else {\n            return getRemoteObjectPreview_primitive(object, stringify);\n        }\n    }\n\n    return '';\n}\n\nexport function getRemoteObjectPreview_object(object: Crdp.Runtime.RemoteObject, context?: string): string {\n    const objectDescription = object.description || '';\n    if ((<string>object.subtype) === 'internal#location') {\n        // Could format this nicely later, see #110\n        return 'internal#location';\n    } else if (object.subtype === 'null') {\n        return 'null';\n    } else if (object.subtype === 'array' || object.subtype === 'typedarray') {\n        return getArrayPreview(object, context);\n    } else if (object.subtype === 'error') {\n        // The Error's description contains the whole stack which is not a nice description.\n        // Up to the first newline is just the error name/message.\n        const firstNewlineIdx = objectDescription.indexOf('\\n');\n        return firstNewlineIdx >= 0 ?\n            objectDescription.substr(0, firstNewlineIdx) :\n            objectDescription;\n    } else if (object.subtype === 'promise' && object.preview) {\n        const promiseStatus = object.preview.properties.filter(prop => prop.name === '[[PromiseStatus]]')[0];\n        return promiseStatus ?\n            objectDescription + ' { ' + promiseStatus.value + ' }' :\n            objectDescription;\n    } else if (object.subtype === 'generator' && object.preview) {\n        const generatorStatus = object.preview.properties.filter(prop => prop.name === '[[GeneratorStatus]]')[0];\n        return generatorStatus ?\n            objectDescription + ' { ' + generatorStatus.value + ' }' :\n            objectDescription;\n    } else if (object.type === 'object' && object.preview) {\n        return getObjectPreview(object, context);\n    } else {\n        return objectDescription;\n    }\n}\n\nexport function getRemoteObjectPreview_primitive(object: Crdp.Runtime.RemoteObject, stringify?: boolean): string {\n    // The value is a primitive value, or something that has a description (not object, primitive, or undefined). And force to be string\n    if (typeof object.value === 'undefined') {\n        return object.description + '';\n    } else if (object.type === 'number') {\n        // .value is truncated, so use .description, the full string representation\n        // Should be like '3' or 'Infinity'.\n        return object.description;\n    } else if (object.type === 'boolean') {\n        // Never stringified\n        return '' + object.value;\n    } else {\n        return stringify ? `\"${object.value}\"` : object.value;\n    }\n}\n\nexport function getRemoteObjectPreview_function(object: Crdp.Runtime.RemoteObject, context?: string): string {\n    const firstBraceIdx = object.description.indexOf('{');\n    if (firstBraceIdx >= 0) {\n        return object.description.substring(0, firstBraceIdx) + '{ … }';\n    } else {\n        const firstArrowIdx = object.description.indexOf('=>');\n        return firstArrowIdx >= 0 ?\n            object.description.substring(0, firstArrowIdx + 2) + ' …' :\n            object.description;\n    }\n}\n"],"sourceRoot":"../../../.."}